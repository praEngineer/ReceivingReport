<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_ui_page">
    <sys_ui_page action="INSERT_OR_UPDATE">
        <category>cms</category>
        <client_script><![CDATA[// Specify the desired rr_year and rr_month values
var defDate = new Date();
defDate.setMonth(defDate.getMonth()-1);
setDesiredRRYear(defDate.getFullYear()); // Replace with your desired year
setDesiredRRMonth(defDate.getMonth()+1);   // Replace with your desired month

refreshTbl();

function getVendorsJSON(response) {
	var answer = "";
	step = 1.1;
	// alert('getRecordsJSON');
	try {
		answer = response.responseXML.querySelector('xml').getAttribute('answer');
		// above line retrieves
		// the response attribute for the 'getRecords' function you defined in your server script.
		step = 2;
		if (answer) {
			step = 3;
			// Process the response data (assuming the response is a JSON array)
			var data = "";
			try {
				data = JSON.parse(answer);
				//alert(step + '. data is: ' + data);
			}
			catch (error) {
				alert(step + '. data catch: ' + error.toString());
			}
			step = 4;
			// Iterate through the results and add rows to the HTML table
			var currRow=1;
			var formattedRow = '';
			document.getElementById('render_vendorSelect').innerHTML = '';
			var selHTML = '<label for="vendorSelect">Select Vendor:</label>';
			selHTML += '<select id="vendorSelect" onChange="chgVendor()">';
			selHTML += '<option value=""></option>';
			data.forEach(function(record) {
				formattedRow = currRow < 10 ? 'Row0' + currRow : 'Row' + currRow;
				// alert(formattedRow);
				step = 16.07;
				selHTML += '<option value="' + record.vendor + '"';
				selHTML += '>' + record.vendor + '</option>';
				currRow += 1;
			});
			
			// Close the HTML table
			selHTML += '</select></div>';
			step = 5;
			// alert(step + '. ');
		} else {
			step = 6;
			html = step + '. vendor answer catch: ' + error.toString();
		}		
		document.getElementById('render_vendorSelect').innerHTML = selHTML;

		step = 7;
	}
	catch (error){
		alert('from client catch: ' + error.toString());
		// html = step + '. from client catch: ' + error.toString() + '<br />' + answer;
	}

}

function renderYearDropDown() {
		var anotherOption = '';
		step = 8;
		var currentYear = parseInt(getDesiredRRYear()); // new Date().getFullYear();
		//alert(step + '. currentYear is ' + currentYear);
		step = 9;
		var yearChoices = [currentYear - 2, currentYear - 1, currentYear, currentYear + 1, currentYear + 2];
		step = 10;
		var defaultYear =  parseInt(getDesiredRRYear()); // new Date().getFullYear();
		step = 11;
		// Populate year options
		var htmlSelectYear = ''
		+ '<label for="yearSelect">Select Year:</label>'
		+ '<select id="yearSelect" onChange="chgYear()">'
		+ '<option value=""></option>';
		step = 12;
		var htmlSelectClose = ''
		+'</select>';
		step = 13;
		// alert(step + '. htmlSelectYear is ' + htmlSelectYear);	

		for (var i = 0; i < yearChoices.length; i++) {
			anotherOption = '<option ';
			if (yearChoices[i] === defaultYear) {
				anotherOption = anotherOption + ' selected '; // Set the default year as selected
			}
			anotherOption = anotherOption + 'value="' + yearChoices[i] + '">';

			anotherOption = anotherOption +  yearChoices[i] + '</option>';

			htmlSelectYear = htmlSelectYear + anotherOption;
		}
		step = 14;
		htmlSelectYear = htmlSelectYear + htmlSelectClose;

		document.getElementById('render_yearSelect').innerHTML = '<div>' + htmlSelectYear + '</div>';
}

function renderVendorDropDown() {
		step = 15;

// 		var currentDate = new Date();
// 		setDesiredRRMonth(currentDate.setMonth(currentDate.getMonth() - 1));
		step = 16.04;
		var previousMonth =  getDesiredRRMonth(); 
		// currentDate.getMonth() +1; 
		// Months are 0-based but my xref is 1-12
		// alert('previousMonth is ' + previousMonth);
		step = 16.05;
		document.getElementById('render_monthSelect').innerHTML = '';
		step = 16.06;
		var selHTML = '<label for="monthSelect">Select Month:</label>';
		selHTML += '<select id="monthSelect" onChange="chgMonth()">';
		selHTML += '<option value=""></option>';
		step = 16.07;
		for (var month = 1; month <= 12; month++) {
			selHTML += '<option value="' + month + '"';
			if (month === previousMonth) {
				selHTML += ' selected';
			}
			selHTML += '>' + getMonthName(month) + '</option>';
		}
		step = 16.08;
		selHTML += '</select>';
		// alert(step + '. selHTML is ' + selHTML);
		document.getElementById('render_monthSelect').innerHTML = '<div>' + selHTML + '</div>';
		step = 16.09;
}


function renderMonthDropDown() {
		step = 15;

// 		var currentDate = new Date();
// 		setDesiredRRMonth(currentDate.setMonth(currentDate.getMonth() - 1));
		step = 16.04;
		var previousMonth =  getDesiredRRMonth(); 
		// currentDate.getMonth() +1; 
		// Months are 0-based but my xref is 1-12
		// alert('previousMonth is ' + previousMonth);
		step = 16.05;
		document.getElementById('render_monthSelect').innerHTML = '';
		step = 16.06;
		var selHTML = '<label for="monthSelect">Select Month:</label>';
		selHTML += '<select id="monthSelect" onChange="chgMonth()">';
		selHTML += '<option value=""></option>';
		step = 16.07;
		for (var month = 1; month <= 12; month++) {
			selHTML += '<option value="' + month + '"';
			if (month === previousMonth) {
				selHTML += ' selected';
			}
			selHTML += '>' + getMonthName(month) + '</option>';
		}
		step = 16.08;
		selHTML += '</select>';
		// alert(step + '. selHTML is ' + selHTML);
		document.getElementById('render_monthSelect').innerHTML = '<div>' + selHTML + '</div>';
		step = 16.09;
}


function refreshTbl() {
// Query the x_dosny_bit_procur_bit_procurement_credit_card_line_items table
// Initialize a GlideAjax instance for making server calls
		var ga = new GlideAjax('ReceivingReportAjaxCall'); // your GlideAjax script include class name

		ga.addParam('sysparm_name', 'getVendorsThisMonth'); 
			// Replace with your (e.g., getRecords) GlideAjax function name within class declaration
		var lclYear = getDesiredRRYear();
		var lclMonth = getDesiredRRMonth();
		ga.addParam('sysparm_rr_year', lclYear);
		ga.addParam('sysparm_rr_month', lclMonth);

		ga.getXML(getVendorsJSON);	
		step = 73;

		renderYearDropDown();
		step = 75;
		
		renderMonthDropDown();
		step = 76;

		renderVendorDropDown();
		step = 76;
	
	alert('made it to step ' + step);	
}



function getMonthName(monthNumber) {
    var months = [
        'January', 'February', 'March', 'April',
        'May', 'June', 'July', 'August',
        'September', 'October', 'November', 'December'
    ];
    return months[monthNumber - 1];
}

function chgYear () {
		//alert('chgYear event');
		ctrlYear = document.getElementById('yearSelect').value;
        setDesiredRRYear(ctrlYear);
		refreshTbl();
    }

function chgMonth() {
		//alert('chgMonth event');
		var ctrlMonth = document.getElementById('monthSelect').value;
        setDesiredRRMonth(ctrlMonth);
		refreshTbl();
    }


var desiredRRYear = '';
var desiredRRMonth = 0;

// Getter function for desiredRRYear
function getDesiredRRYear() {
  if(desiredRRYear.length == 0){
	setDesiredRRYear(2023);
  }
  return desiredRRYear;
}

// Setter function for desiredRRYear
function setDesiredRRYear(newYear) {
  desiredRRYear = newYear;
}


// Setter function for desiredRRMonth
function setDesiredRRMonth(newMonth) {
  step = 16.044;
  desiredRRMonth = parseInt(newMonth);
}

// Getter function for desiredRRMonth
function getDesiredRRMonth() {
	step = 16.041;
	if(desiredRRMonth.length == 0){
		step = 16.0421;
		var lclDate = new Date();
		step = 16.0422;
		lclDate.setMonth(lclDate.getMonth()-1);
		step = 16.0423;
		var lclMonth = lclDate.getMonth();
		step = 16.0424;
		alert(step + '. lclMonth is ' + lclMonth);
		setDesiredRRMonth(lclMonth);
		step = 16.0425;
	}
	step = 16.043;
  //alert(step + '. getDesiredRRMonth is ' + desiredRRMonth);
  return desiredRRMonth;
}]]></client_script>
        <description>Using month and year input, return a unique list of vendors which were paid via credit cards</description>
        <direct>false</direct>
        <endpoint>x_dosny_vendorrepo_ReceivingReportVendorsThisMonth.do</endpoint>
        <html><![CDATA[<?xml version="1.0" encoding="utf-8" ?>
<j:jelly trim="false" xmlns:j="jelly:core" xmlns:g="glide" xmlns:j2="null" xmlns:g2="null">
<html>
	<head>
		<style type="text/css">* {
      margin: 0;
      padding: 0;
      text-indent: 0;
    }

    .s1 {
      color: #262626;
      font-family: Arial, sans-serif;
      font-style: normal;
      font-weight: normal;
      text-decoration: none;
      font-size: 6pt;
    }

    .s2 {
      color: #131313;
      font-family: Arial, sans-serif;
      font-style: normal;
      font-weight: normal;
      text-decoration: none;
      font-size: 6pt;
    }

    h3 {
      color: #131313;
      font-family: Arial, sans-serif;
      font-style: normal;
      font-weight: bold;
      text-decoration: none;
      font-size: 6pt;
    }

    .s6 {
      color: #131313;
      font-family: Arial, sans-serif;
      font-style: normal;
      font-weight: bold;
      text-decoration: none;
      font-size: 9pt;
    }

    h2 {
      color: #131313;
      font-family: Arial, sans-serif;
      font-style: normal;
      font-weight: bold;
      text-decoration: none;
      font-size: 7pt;
    }

    p {
      color: #131313;
      font-family: Arial, sans-serif;
      font-style: normal;
      font-weight: normal;
      text-decoration: none;
      font-size: 7pt;
      margin: 0pt;
    }

    .s8 {
      color: #262626;
      font-family: Arial, sans-serif;
      font-style: normal;
      font-weight: normal;
      text-decoration: underline;
      font-size: 7pt;
    }

    .s14 {
      color: #131313;
      font-family: Arial, sans-serif;
      font-style: normal;
      font-weight: normal;
      text-decoration: none;
      font-size: 17pt;
    }

    .s15 {
      color: #131313;
      font-family: Arial, sans-serif;
      font-style: normal;
      font-weight: normal;
      text-decoration: none;
      font-size: 7pt;
    }
    .s15a {
      color: #131313;
	  background-color: #D3D3D3;
      font-family: Arial, sans-serif;
      font-style: normal;
      font-weight: normal;
      text-decoration: none;
      font-size: 7pt;
    }
    .s16 {
      color: black;
      font-family: Arial, sans-serif;
      font-style: normal;
      font-weight: normal;
      text-decoration: none;
      font-size: 7pt;
    }

    .s17 {
      color: #262626;
      font-family: Arial, sans-serif;
      font-style: normal;
      font-weight: normal;
      text-decoration: none;
      font-size: 6pt;
    }

    .s19 {
      color: #A5A5A5;
      font-family: Arial, sans-serif;
      font-style: normal;
      font-weight: normal;
      text-decoration: none;
      font-size: 6pt;
    }

    .s20 {
      color: #4F4F4F;
      font-family: "Times New Roman", serif;
      font-style: normal;
      font-weight: normal;
      text-decoration: none;
      font-size: 4pt;
    }

    .s21 {
      color: #4F4F4F;
      font-family: Arial, sans-serif;
      font-style: normal;
      font-weight: normal;
      text-decoration: none;
      font-size: 4pt;
    }

    .s23 {
      color: #4F4F4F;
      font-family: "Times New Roman", serif;
      font-style: normal;
      font-weight: normal;
      text-decoration: none;
      font-size: 4.5pt;
    }

    .s24 {
      color: #131313;
      font-family: Arial, sans-serif;
      font-style: normal;
      font-weight: normal;
      text-decoration: none;
      font-size: 6pt;
    }

    .s25 {
      color: #131313;
      font-family: Arial, sans-serif;
      font-style: normal;
      font-weight: normal;
      text-decoration: none;
      font-size: 7pt;
      vertical-align: 4pt;
    }

    .s26 {
      color: black;
      font-family: Arial, sans-serif;
      font-style: normal;
      font-weight: normal;
      text-decoration: none;
      font-size: 12pt;
    }

    .s27 {
      color: black;
      font-family: Arial, sans-serif;
      font-style: normal;
      font-weight: normal;
      text-decoration: none;
      font-size: 10.5pt;
    }

    .s28 {
      color: #3A3A3A;
      font-family: Arial, sans-serif;
      font-style: normal;
      font-weight: normal;
      text-decoration: none;
      font-size: 6pt;
    }

    .s30 {
      color: #262626;
      font-family: Arial, sans-serif;
      font-style: normal;
      font-weight: normal;
      text-decoration: none;
      font-size: 6pt;
    }

    .s31 {
      color: #131313;
      font-family: Arial, sans-serif;
      font-style: normal;
      font-weight: normal;
      text-decoration: none;
      font-size: 17pt;
      vertical-align: -8pt;
    }

    .s32 {
      color: #262626;
      font-family: Arial, sans-serif;
      font-style: normal;
      font-weight: normal;
      text-decoration: none;
      font-size: 6pt;
    }

    .s36 {
      color: black;
      font-family: "Times New Roman", serif;
      font-style: normal;
      font-weight: normal;
      text-decoration: none;
      font-size: 10pt;
    }

    .s39 {
      color: #131313;
      font-family: Arial, sans-serif;
      font-style: normal;
      font-weight: bold;
      text-decoration: none;
      font-size: 6pt;
    }

    .s40 {
      color: #B8B8B8;
      font-family: Arial, sans-serif;
      font-style: normal;
      font-weight: normal;
      text-decoration: none;
      font-size: 4.5pt;
    }

    .s41 {
      color: #A5A5A5;
      font-family: Arial, sans-serif;
      font-style: normal;
      font-weight: normal;
      text-decoration: none;
      font-size: 9pt;
    }

    .s42 {
      color: #A5A5A5;
      font-family: Arial, sans-serif;
      font-style: normal;
      font-weight: normal;
      text-decoration: none;
      font-size: 13pt;
    }

    .s43 {
      color: #4F4F4F;
      font-family: Arial, sans-serif;
      font-style: normal;
      font-weight: normal;
      text-decoration: none;
      font-size: 25pt;
    }

    .s44 {
      color: black;
      font-family: Arial, sans-serif;
      font-style: normal;
      font-weight: normal;
      text-decoration: none;
      font-size: 12pt;
    }

    .s45 {
      color: #131313;
      font-family: Arial, sans-serif;
      font-style: normal;
      font-weight: normal;
      text-decoration: underline;
      font-size: 7pt;
    }

    .s47 {
      color: #262626;
      font-family: Arial, sans-serif;
      font-style: normal;
      font-weight: normal;
      text-decoration: none;
      font-size: 6pt;
    }

    .s51 {
      color: #4F4F4F;
      font-family: Arial, sans-serif;
      font-style: normal;
      font-weight: normal;
      text-decoration: underline;
      font-size: 7pt;
    }

    .s56 {
      color: #131313;
      font-family: Arial, sans-serif;
      font-style: normal;
      font-weight: bold;
      text-decoration: none;
      font-size: 4.5pt;
    }

    .s57 {
      color: #131313;
      font-family: Arial, sans-serif;
      font-style: normal;
      font-weight: normal;
      text-decoration: none;
      font-size: 5pt;
    }

    h1 {
      color: #262626;
      font-family: Arial, sans-serif;
      font-style: normal;
      font-weight: bold;
      text-decoration: none;
      font-size: 9pt;
    }

    .s59 {
      color: #3A3A3A;
      font-family: "Times New Roman", serif;
      font-style: normal;
      font-weight: normal;
      text-decoration: none;
      font-size: 6pt;
    }

    .s60 {
      color: #4F4F4F;
      font-family: "Times New Roman", serif;
      font-style: normal;
      font-weight: normal;
      text-decoration: none;
      font-size: 6pt;
    }

    .s61 {
      color: #262626;
      font-family: "Times New Roman", serif;
      font-style: normal;
      font-weight: normal;
      text-decoration: none;
      font-size: 6.5pt;
    }

    .s62 {
      color: #3A3A3A;
      font-family: "Times New Roman", serif;
      font-style: normal;
      font-weight: normal;
      text-decoration: none;
      font-size: 6.5pt;
    }

    .s63 {
      color: #3A3A3A;
      font-family: Arial, sans-serif;
      font-style: normal;
      font-weight: normal;
      text-decoration: none;
      font-size: 4pt;
    }

    .s64 {
      color: #262626;
      font-family: "Times New Roman", serif;
      font-style: normal;
      font-weight: bold;
      text-decoration: none;
      font-size: 4.5pt;
    }

    .s65 {
      color: #262626;
      font-family: Arial, sans-serif;
      font-style: normal;
      font-weight: normal;
      text-decoration: none;
      font-size: 4pt;
    }

    .s66 {
      color: #262626;
      font-family: Arial, sans-serif;
      font-style: normal;
      font-weight: normal;
      text-decoration: none;
      font-size: 7pt;
    }

    .s67 {
      color: #262626;
      font-family: "Times New Roman", serif;
      font-style: normal;
      font-weight: normal;
      text-decoration: none;
      font-size: 6pt;
    }
	.resize-image {
		max-width: 850px;
		max-height: 340px;
		text-align: center;
	  }
			
    table,
    tbody {
      vertical-align: top;
      overflow: visible;
    }</style>
	</head>
	<body>
		<form id='frmReceivingReport' onSubmit='javascript:alert("submitted")'>
		<div id='render_yearSelect'>Default year select</div>
		<div id='render_monthSelect'>Default month select</div>
		<div id='render_vendorSelect'>Default vendor select</div>
		</form>
	</body>
	</html>
</j:jelly>]]></html>
        <name>ReceivingReportVendorsThisMonth</name>
        <processing_script/>
        <sys_class_name>sys_ui_page</sys_class_name>
        <sys_created_by>sfarkas</sys_created_by>
        <sys_created_on>2023-09-18 20:25:59</sys_created_on>
        <sys_id>79a54be61b9db9106c1036ef034bcb07</sys_id>
        <sys_mod_count>4</sys_mod_count>
        <sys_name>ReceivingReportVendorsThisMonth</sys_name>
        <sys_package display_value="ReceivingReport" source="x_dosny_vendorrepo">bbcb77921bcdf110baac766e034bcb72</sys_package>
        <sys_policy/>
        <sys_scope display_value="ReceivingReport">bbcb77921bcdf110baac766e034bcb72</sys_scope>
        <sys_update_name>sys_ui_page_79a54be61b9db9106c1036ef034bcb07</sys_update_name>
        <sys_updated_by>sfarkas</sys_updated_by>
        <sys_updated_on>2023-09-18 21:02:56</sys_updated_on>
    </sys_ui_page>
</record_update>
